WITH CTE AS (
    SELECT CUSTOMER_ID,YEAR(ORDER_DATE)AS YEARS ,SUM(PRICE) AS S_PRICE FROM ORDERS GROUP BY CUSTOMER_ID,YEARS ORDER BY CUSTOMER_ID,YEARS
)
SELECT C1.CUSTOMER_ID FROM CTE C1  LEFT JOIN CTE C2 ON C1.CUSTOMER_ID = C2.CUSTOMER_ID AND C1.YEARS + 1 = C2.YEARS AND C1.S_PRICE < C2.S_PRICE GROUP BY C1.CUSTOMER_ID HAVING COUNT(*) - COUNT(C2.CUSTOMER_ID) = 1;